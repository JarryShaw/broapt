## Configuration for API arguments of BroAPT-APP

###############################################################################
## Environment (global setup)
##
## Environment variables `${...}` used in API arguments will be translated
## according to the following values.
##
environment:
  # Python 3.6
  PYTHON: /usr/bin/python3.6
  PYTHON36: /usr/bin/python3.6
  PYTHON3: /usr/bin/python3.6
  # Python 2.7
  PYTHON27: /usr/bin/python
  PYTHON2: /usr/bin/python
  # Shell/Bash
  SHELL: /bin/bash

###############################################################################
## Example:
##
## - Target:
##   - MIME type: `application/pdf`
##   - file name: `/dump/application/pdf/test.pdf`
## - API:
##   - argument: `python2.7 pdf_analysis/detect.py`
##   - API root: `/api/`
##   - environment: `ENV_FOO=1`, `ENV_BAR=this is an environment variable`
##
## The configuration section should then be:
##
## application:
##   ...  # other APIs
##   pdf:
##     # assume using Python 2.7 environment
##     environ:
##       ENV_FOO: 1
##       ENV_BAR: this is an environment variable
##     install:
##       - apt-get update && apt-get install -y python
##       - pip install -r requirements.txt
##     scripts:
##       - ${PYTHON27} pdf_analysis/detect.py [...]        # refer to /usr/bin/python
##       - ...                                             # and some random command
##
## BroAPT will work as following:
##
## 0. if run for the first time, run the following commands:
##    - `apt-get update && apt-get install -y python`
##    - `pip install -r requirements.txt`
## 1. set the following environment variables
##    # per target file
##    - BROAPT_APP_FILE="/dump/application/pdf/test.pdf"
##    - BROAPT_APP_MIME="application/pdf"
##    # per API configuration
##    - ENV_FOO=1
##    - ENV_BAR="this is an environment variable"
## 2. change the current working directory to
##    `/api/application/pdf`
## 3. call the API as the following commands:
##    - `/usr/bin/python pdf_analysis/detect.py [...]`
##    - `...`
##
## NOTE: `scripts` section is MANDATORY.
##

# APIs for `application` media type
application:

# APIs for `audio` media type
audio:

# Default API for missing MIME types
example:
  environ:
    ## sleep interval
    VT_INTERVAL: 10
    ## max retry for report
    VT_RETRY: 6
    ## VT API key
    VT_API: f8b5e766a0d15fa2b3d6b3bdd526d4346816c09b78409632d5b8fa88a3a21940
    ## path to VT file scan reports
    VT_LOG: /var/log/bro/tmp/
  install:
    - apt-get update &&
      apt-get install -y --no-install-recommends python3-requests
  scripts:
    - ${PYTHON36} virustotal.py

# APIs for `font` media type
font:

# APIs for `image` media type
image:

# APIs for `message` media type
message:

# APIs for `model` media type
model:

# APIs for `multipart` media type
multipart:

# APIs for `text` media type
text:

# APIs for `video` media type
video:
