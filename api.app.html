
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>BroAPT-App Framework &#8212; BroAPT 2020.03.14 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module Entry" href="api.app.python.__init__.html" />
    <link rel="prev" title="Site Customisations" href="api.core.python.sites.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="broapt-app-framework">
<h1>BroAPT-App Framework<a class="headerlink" href="#broapt-app-framework" title="Permalink to this heading">¶</a></h1>
<p>The BroAPT-App framework is the analysis framework for the BroAPT
system. For more information about the framework, please refer to previous
documentation at <a class="reference internal" href="broapt-app.html"><span class="doc">BroAPT-App Detection Framework</span></a>.</p>
<section id="python-modules">
<h2>Python Modules<a class="headerlink" href="#python-modules" title="Permalink to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.__init__.html">Module Entry</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.__main__.html">System Entrypoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.__main__.html#constants">Constants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#main__.FILE_REGEX"><code class="docutils literal notranslate"><span class="pre">__main__.FILE_REGEX</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.__main__.html#dataclasses">Dataclasses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#scan.MIME"><code class="docutils literal notranslate"><span class="pre">scan.MIME</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.MIME.media_type"><code class="docutils literal notranslate"><span class="pre">scan.MIME.media_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.MIME.subtype"><code class="docutils literal notranslate"><span class="pre">scan.MIME.subtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.MIME.name"><code class="docutils literal notranslate"><span class="pre">scan.MIME.name</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#main__.MIME"><code class="docutils literal notranslate"><span class="pre">__main__.MIME</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#scan.Entry"><code class="docutils literal notranslate"><span class="pre">scan.Entry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.Entry.path"><code class="docutils literal notranslate"><span class="pre">scan.Entry.path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.Entry.uuid"><code class="docutils literal notranslate"><span class="pre">scan.Entry.uuid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.Entry.mime"><code class="docutils literal notranslate"><span class="pre">scan.Entry.mime</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#main__.Entry"><code class="docutils literal notranslate"><span class="pre">__main__.Entry</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.__main__.html#bundled-implementation">Bundled Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#scan-module"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scan</span></code> Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.scan"><code class="docutils literal notranslate"><span class="pre">scan.scan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#scan.lookup"><code class="docutils literal notranslate"><span class="pre">scan.lookup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#remote-module"><code class="xref py py-mod docutils literal notranslate"><span class="pre">remote</span></code> Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#framework-mainloop">Framework Mainloop</a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.__main__.html#signal-handling">Signal Handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.__main__.html#cluster-implementation">Cluster Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#main__.listdir"><code class="docutils literal notranslate"><span class="pre">__main__.listdir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#main__.check_history"><code class="docutils literal notranslate"><span class="pre">__main__.check_history()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.__main__.html#main__.main"><code class="docutils literal notranslate"><span class="pre">__main__.main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.cfgparser.html">API Config Parser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.cfgparser.html#dataclasses">Dataclasses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API"><code class="docutils literal notranslate"><span class="pre">cfgparser.API</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.workdir"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.workdir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.environ"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.environ</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.install"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.install</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.scripts"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.scripts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.report"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.report</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.remote"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.remote</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.shared"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.shared</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.inited"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.inited</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API.locked"><code class="docutils literal notranslate"><span class="pre">cfgparser.API.locked</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.cfgparser.html#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.parse_cmd"><code class="docutils literal notranslate"><span class="pre">cfgparser.parse_cmd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.parse"><code class="docutils literal notranslate"><span class="pre">cfgparser.parse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.cfgparser.html#constants">Constants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.MEDIA_TYPE"><code class="docutils literal notranslate"><span class="pre">cfgparser.MEDIA_TYPE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API_DICT"><code class="docutils literal notranslate"><span class="pre">cfgparser.API_DICT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API_LOCK"><code class="docutils literal notranslate"><span class="pre">cfgparser.API_LOCK</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.API_INIT"><code class="docutils literal notranslate"><span class="pre">cfgparser.API_INIT</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.cfgparser.html#exceptions">Exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.ConfigError"><code class="docutils literal notranslate"><span class="pre">cfgparser.ConfigError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.DefaultNotFoundError"><code class="docutils literal notranslate"><span class="pre">cfgparser.DefaultNotFoundError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.cfgparser.html#cfgparser.ReportNotFoundError"><code class="docutils literal notranslate"><span class="pre">cfgparser.ReportNotFoundError</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.const.html">Common Constants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.ROOT"><code class="docutils literal notranslate"><span class="pre">const.ROOT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.CPU_CNT"><code class="docutils literal notranslate"><span class="pre">const.CPU_CNT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.INTERVAL"><code class="docutils literal notranslate"><span class="pre">const.INTERVAL</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.MAX_RETRY"><code class="docutils literal notranslate"><span class="pre">const.MAX_RETRY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.EXIT_SUCCESS"><code class="docutils literal notranslate"><span class="pre">const.EXIT_SUCCESS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.EXIT_FAILURE"><code class="docutils literal notranslate"><span class="pre">const.EXIT_FAILURE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.LOGS_PATH"><code class="docutils literal notranslate"><span class="pre">const.LOGS_PATH</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.DUMP_PATH"><code class="docutils literal notranslate"><span class="pre">const.DUMP_PATH</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.API_ROOT"><code class="docutils literal notranslate"><span class="pre">const.API_ROOT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.API_LOGS"><code class="docutils literal notranslate"><span class="pre">const.API_LOGS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.API_DICT"><code class="docutils literal notranslate"><span class="pre">const.API_DICT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.SERVER_NAME_HOST"><code class="docutils literal notranslate"><span class="pre">const.SERVER_NAME_HOST</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.SERVER_NAME_PORT"><code class="docutils literal notranslate"><span class="pre">const.SERVER_NAME_PORT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.SERVER_NAME"><code class="docutils literal notranslate"><span class="pre">const.SERVER_NAME</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.DUMP"><code class="docutils literal notranslate"><span class="pre">const.DUMP</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.FAIL"><code class="docutils literal notranslate"><span class="pre">const.FAIL</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.FILE_REGEX"><code class="docutils literal notranslate"><span class="pre">const.FILE_REGEX</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.MIME_REGEX"><code class="docutils literal notranslate"><span class="pre">const.MIME_REGEX</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.const.html#const.QUEUE_DUMP"><code class="docutils literal notranslate"><span class="pre">const.QUEUE_DUMP</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.process.html">Detection Process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.process.html#bundled-implementation">Bundled Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.process"><code class="docutils literal notranslate"><span class="pre">scan.process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.make_env"><code class="docutils literal notranslate"><span class="pre">scan.make_env()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.make_cwd"><code class="docutils literal notranslate"><span class="pre">scan.make_cwd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.init"><code class="docutils literal notranslate"><span class="pre">scan.init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.run"><code class="docutils literal notranslate"><span class="pre">scan.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.issue"><code class="docutils literal notranslate"><span class="pre">scan.issue()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.APIWarning"><code class="docutils literal notranslate"><span class="pre">scan.APIWarning</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#scan.APIError"><code class="docutils literal notranslate"><span class="pre">scan.APIError</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.process.html#cluster-implementation">Cluster Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#process.process"><code class="docutils literal notranslate"><span class="pre">process.process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#process.make_env"><code class="docutils literal notranslate"><span class="pre">process.make_env()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#process.make_cwd"><code class="docutils literal notranslate"><span class="pre">process.make_cwd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#process.init"><code class="docutils literal notranslate"><span class="pre">process.init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#process.run"><code class="docutils literal notranslate"><span class="pre">process.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#process.issue"><code class="docutils literal notranslate"><span class="pre">process.issue()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#utils.APIWarning"><code class="docutils literal notranslate"><span class="pre">utils.APIWarning</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.process.html#utils.APIError"><code class="docutils literal notranslate"><span class="pre">utils.APIError</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.remote.html">Remote Detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.remote.html#bundled-implementation">Bundled Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.remote.html#scan.remote"><code class="docutils literal notranslate"><span class="pre">scan.remote()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.remote.html#cluster-implementation">Cluster Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.app.python.remote.html#remote.remote"><code class="docutils literal notranslate"><span class="pre">remote.remote()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.app.python.utils.html">Auxiliaries &amp; Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.utils.html#utils.suppress"><code class="docutils literal notranslate"><span class="pre">utils.suppress()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.utils.html#utils.file_lock"><code class="docutils literal notranslate"><span class="pre">utils.file_lock()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.utils.html#utils.temp_env"><code class="docutils literal notranslate"><span class="pre">utils.temp_env()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.python.utils.html#utils.print_file"><code class="docutils literal notranslate"><span class="pre">utils.print_file()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="api-configurations">
<h2>API Configurations<a class="headerlink" href="#api-configurations" title="Permalink to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">File location<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>Bundled implementation: <code class="docutils literal notranslate"><span class="pre">source/include/api/</span></code></p></li>
<li><p>Cluster implementation: <code class="docutils literal notranslate"><span class="pre">cluster/app/include/api/</span></code></p></li>
</ul>
</dd>
</dl>
<p>As discussed in previous documentation, we provided a YAML configuration file
<code class="docutils literal notranslate"><span class="pre">api.yml</span></code> for registering MIME type specific detection methods.</p>
<p>For example, following is the requirements of an API for analysing PDF files
(MIME type: <code class="docutils literal notranslate"><span class="pre">application/pdf</span></code>):</p>
<ul class="simple">
<li><p>Root: <code class="docutils literal notranslate"><span class="pre">/api/</span></code></p></li>
<li><p>Target:
- MIME type: <code class="docutils literal notranslate"><span class="pre">application/pdf</span></code>
- file name: <code class="docutils literal notranslate"><span class="pre">/dump/application/pdf/test.pdf</span></code></p></li>
<li><p>API:
- working directory: <code class="docutils literal notranslate"><span class="pre">./pdf_analysis</span></code>
- environment: <code class="docutils literal notranslate"><span class="pre">ENV_FOO=1</span></code>, <code class="docutils literal notranslate"><span class="pre">ENV_BAR=this</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">environment</span> <span class="pre">variable</span></code></p></li>
</ul>
<p>The configuration section should then be:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">application</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w">  </span><span class="c1"># other APIs</span>
<span class="w">  </span><span class="nt">pdf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">remote</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pdf_analysis</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ENV_FOO</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">ENV_BAR</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">this is an environment variable</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get update</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get install -y python python-pip</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python -m pip install -r requirements.txt</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rm -rf /var/lib/apt/lists/*</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get remove -y --auto-remove python-pip</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get clean</span>
<span class="w">    </span><span class="nt">scripts</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON27} detect.py [...]</span><span class="w">                </span><span class="c1"># refer to /usr/bin/python</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w">                                        </span><span class="c1"># and some random command</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON27} report.py</span><span class="w">                  </span><span class="c1"># generate final report</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><code class="docutils literal notranslate"><span class="pre">report</span></code> section is <strong>MANDATORY</strong>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">remote</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>, then the BroAPT-APP framework will run the
corresponding API in the host machine through the BroAPT-Daemon server.</p>
</div>
<p>The BroAPT-App framework will work as following:</p>
<ol class="arabic simple">
<li><p>set the following environment variables:</p>
<ul class="simple">
<li><p>per target file</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">BROAPT_PATH=&quot;/dump/application/pdf/test.pdf&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BROAPT_MIME=&quot;application/pdf&quot;</span></code></p></li>
</ul>
</li>
<li><p>per API configuration</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ENV_FOO=1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ENV_BAR=&quot;this</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">environment</span> <span class="pre">variable&quot;</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>change the current working directory to
<code class="docutils literal notranslate"><span class="pre">/api/application/pdf/pdf_analysis</span></code></p></li>
<li><p>if run for the first time, run the following commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">update</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">python</span> <span class="pre">python-pip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rm</span> <span class="pre">-rf</span> <span class="pre">/var/lib/apt/lists/*</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">remove</span> <span class="pre">-y</span> <span class="pre">--auto-remove</span> <span class="pre">python-pip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">clean</span></code></p></li>
</ul>
</li>
<li><p>run the following mid-stage commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span> <span class="pre">detect.py</span> <span class="pre">[...]</span></code></p></li>
<li><p>…</p></li>
</ul>
</li>
<li><p>generate final report:
<code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span> <span class="pre">report.py</span></code></p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The registered MIME types support <em>shell</em>-like patterns.</p>
<p>If the API of a specific MIME type is not provided, it will then fallback
to the API configuration registered under the special <code class="docutils literal notranslate"><span class="pre">example</span></code> MIME type.</p>
</div>
<details>
  <summary>Content of <code class="docutils literal notranslate"><span class="pre">api.yml</span></code> (bundled implementation)</summary><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1">## Configuration for API arguments of BroAPT-APP</span>

<span class="c1">###############################################################################</span>
<span class="c1">## Environment (global setup)</span>
<span class="c1">##</span>
<span class="c1">## Environment variables `${...}` used in API arguments will be translated</span>
<span class="c1">## according to the following values.</span>
<span class="c1">##</span>
<span class="nt">environment</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># API root path</span>
<span class="w">  </span><span class="nt">API_ROOT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${BROAPT_API_ROOT}</span>
<span class="w">  </span><span class="c1"># Python 3.6</span>
<span class="w">  </span><span class="nt">PYTHON</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python3.6</span>
<span class="w">  </span><span class="nt">PYTHON36</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python3.6</span>
<span class="w">  </span><span class="nt">PYTHON3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python3.6</span>
<span class="w">  </span><span class="c1"># Python 2.7</span>
<span class="w">  </span><span class="nt">PYTHON27</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python</span>
<span class="w">  </span><span class="nt">PYTHON2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python</span>
<span class="w">  </span><span class="c1"># Shell/Bash</span>
<span class="w">  </span><span class="nt">SHELL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/bin/bash</span>

<span class="c1">###############################################################################</span>
<span class="c1">## Example:</span>
<span class="c1">##</span>
<span class="c1">## - Root: `/api/`</span>
<span class="c1">## - Target:</span>
<span class="c1">##   - MIME type: `application/pdf`</span>
<span class="c1">##   - file name: `/dump/application/pdf/test.pdf`</span>
<span class="c1">## - API:</span>
<span class="c1">##   - working directory: `./pdf_analysis`</span>
<span class="c1">##   - environment: `ENV_FOO=1`, `ENV_BAR=this is an environment variable`</span>
<span class="c1">##</span>
<span class="c1">## The configuration section should then be:</span>
<span class="c1">##</span>
<span class="c1">## application:</span>
<span class="c1">##   ...  # other APIs</span>
<span class="c1">##   pdf:</span>
<span class="c1">##     remote: false</span>
<span class="c1">##     workdir: pdf_analysis</span>
<span class="c1">##     environ:</span>
<span class="c1">##       ENV_FOO: 1</span>
<span class="c1">##       ENV_BAR: this is an environment variable</span>
<span class="c1">##     install:</span>
<span class="c1">##       - apt-get update</span>
<span class="c1">##       - apt-get install -y python python-pip</span>
<span class="c1">##       - python -m pip install -r requirements.txt</span>
<span class="c1">##       - rm -rf /var/lib/apt/lists/*</span>
<span class="c1">##       - apt-get remove -y --auto-remove python-pip</span>
<span class="c1">##       - apt-get clean</span>
<span class="c1">##     scripts:</span>
<span class="c1">##       - ${PYTHON27} detect.py [...]                # refer to /usr/bin/python</span>
<span class="c1">##       - ...                                        # and some random command</span>
<span class="c1">##     report: ${PYTHON27} report.py                  # generate final report</span>
<span class="c1">##</span>
<span class="c1">## BroAPT will work as following:</span>
<span class="c1">##</span>
<span class="c1">## 1. set the following environment variables</span>
<span class="c1">##    # per target file</span>
<span class="c1">##    - BROAPT_PATH=&quot;/dump/application/pdf/test.pdf&quot;</span>
<span class="c1">##    - BROAPT_MIME=&quot;application/pdf&quot;</span>
<span class="c1">##    # per API configuration</span>
<span class="c1">##    - ENV_FOO=1</span>
<span class="c1">##    - ENV_BAR=&quot;this is an environment variable&quot;</span>
<span class="c1">## 2. change the current working directory to</span>
<span class="c1">##    `/api/application/pdf/pdf_analysis`</span>
<span class="c1">## 3. if run for the first time, run the following commands:</span>
<span class="c1">##    - `apt-get update`</span>
<span class="c1">##    - `apt-get install -y python python-pip`</span>
<span class="c1">##    - `python -m pip install -r requirements.txt`</span>
<span class="c1">##    - `rm -rf /var/lib/apt/lists/*`</span>
<span class="c1">##    - `apt-get remove -y --auto-remove python-pip`</span>
<span class="c1">##    - `apt-get clean`</span>
<span class="c1">## 4. run the following mid-stage commands:</span>
<span class="c1">##    - `/usr/bin/python detect.py [...]`</span>
<span class="c1">##    - `...`</span>
<span class="c1">## 5. generate final report:</span>
<span class="c1">##    `/usr/bin/python report.py`</span>
<span class="c1">##</span>
<span class="c1">## NOTE: `report` section is MANDATORY.</span>
<span class="c1">##       If `remote` is `true`, then BroAPT will run the</span>
<span class="c1">##       corresponding API in the host machine.</span>
<span class="c1">##</span>

<span class="c1"># APIs for `application` media type</span>
<span class="nt">application</span><span class="p">:</span>
<span class="w">  </span><span class="nt">javascript</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;javascript</span>
<span class="w">    </span><span class="c1">## JaSt</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${API_ROOT}/application/javascript/JaSt</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">JS_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yum install -y epel-release</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yum install -y git nodejs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./JaSt/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/Aurore54F/JaSt.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON3} -m pip install</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">matplotlib</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">plotly</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">scipy</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">scikit-learn</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON3} ./JaSt/clustering/learner.py</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--d ./sample/</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--l ./lables/</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--md ./models/</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--mn broapt-jast</span>
<span class="w">    </span><span class="nt">scripts</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON3} ./JaSt/clustering/classifier.py</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--f ${BROAPT_PATH}</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--m ./models/broapt-jast</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span>
<span class="w">  </span><span class="nt">octet-stream</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;lmd</span>
<span class="w">    </span><span class="c1">## LMD</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${API_ROOT}/application/octet-stream/LMD</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">LMD_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yum install -y git which</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./linux-malware-detect/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/rfxn/linux-malware-detect.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} install.sh</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} detect.sh</span>
<span class="w">  </span><span class="nt">vnd.android.package-archive</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## AndroPyTool</span>
<span class="w">    </span><span class="nt">remote</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AndroPyTool</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># ANDROID_HOME: $HOME/android-sdk-linux</span>
<span class="w">      </span><span class="c1"># PATH: $PATH:$ANDROID_HOME/tools</span>
<span class="w">      </span><span class="c1"># PATH: $PATH:$ANDROID_HOME/platform-tools</span>
<span class="w">      </span><span class="c1"># APK_LOG: /var/log/bro/tmp/</span>
<span class="w">      </span><span class="nt">APK_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/traffic/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># - ${SHELL} install.sh</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker pull alexmyg/andropytool</span>
<span class="w">    </span><span class="c1"># report: ${PYTHON36} detect.py</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} detect.sh</span>
<span class="w">  </span><span class="nt">vnd.openxmlformats-officedocument</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;officedocument</span>
<span class="w">    </span><span class="c1">## MaliciousMacroBot</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${API_ROOT}/application/vnd.openxmlformats-officedocument/</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MMB_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yum install -y git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./MaliciousMacroBot/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/egaus/MaliciousMacroBot.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON36} -m pip install ./MaliciousMacroBot/</span>
<span class="w">      </span><span class="c1"># - rm -rf ./MaliciousMacroBot/</span>
<span class="w">      </span><span class="c1"># - yum erase -y git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yum clean -y all</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON36} MaliciousMacroBot-detect.py</span>
<span class="w">    </span><span class="nt">shared</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">officedocument</span>
<span class="w">  </span><span class="nt">msword</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">vnd.ms-*</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">vnd.openxmlformats-officedocument</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">vnd.openxmlformats-officedocument.*</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">x-executable</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## ELF Parser</span>
<span class="w">    </span><span class="nt">remote</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># ELF_LOG: /var/log/bro/tmp/</span>
<span class="w">      </span><span class="nt">ELF_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/traffic/log/bro/tmp/</span>
<span class="w">      </span><span class="nt">ELF_SCORE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ELF-Parser</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker build --tag elfparser:1.4.0 --rm .</span>
<span class="w">      </span><span class="c1"># - yum install -y git cmake make boost-devel gcc gcc-g++</span>
<span class="w">      </span><span class="c1"># - test -d ./elfparser/ ||</span>
<span class="w">      </span><span class="c1">#   git clone https://github.com/jacob-baines/elfparser.git</span>
<span class="w">      </span><span class="c1"># - ${SHELL} build.sh</span>
<span class="w">      </span><span class="c1"># - rm -rf ./elfparser/</span>
<span class="w">      </span><span class="c1"># # - yum erase -y git cmake make</span>
<span class="w">      </span><span class="c1"># - yum clean -y all</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} detect.sh</span>

<span class="c1"># APIs for `audio` media type</span>
<span class="nt">audio</span><span class="p">:</span>

<span class="c1"># Default API for missing MIME types</span>
<span class="nt">example</span><span class="p">:</span>
<span class="w">  </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## sleep interval</span>
<span class="w">    </span><span class="nt">VT_INTERVAL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="c1">## max retry for report</span>
<span class="w">    </span><span class="nt">VT_RETRY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="c1">## percentage of positive threshold</span>
<span class="w">    </span><span class="nt">VT_PERCENT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="c1">## VT API key</span>
<span class="w">    </span><span class="c1">#VT_API: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="w">    </span><span class="c1">## path to VT file scan reports</span>
<span class="w">    </span><span class="nt">VT_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">  </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON36} virustotal.py || exit 0</span><span class="w"> </span><span class="c1"># always EXIT_SUCCESS</span>

<span class="c1"># APIs for `font` media type</span>
<span class="nt">font</span><span class="p">:</span>

<span class="c1"># APIs for `image` media type</span>
<span class="nt">image</span><span class="p">:</span>

<span class="c1"># APIs for `message` media type</span>
<span class="nt">message</span><span class="p">:</span>

<span class="c1"># APIs for `model` media type</span>
<span class="nt">model</span><span class="p">:</span>

<span class="c1"># APIs for `multipart` media type</span>
<span class="nt">multipart</span><span class="p">:</span>

<span class="c1"># APIs for `text` media type</span>
<span class="nt">text</span><span class="p">:</span>
<span class="w">  </span><span class="nt">html</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>
<span class="w">  </span><span class="nt">javascript</span><span class="p">:</span><span class="w"> </span><span class="nv">*javascript</span>
<span class="w">  </span><span class="nt">x-c</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>
<span class="w">  </span><span class="nt">x-perl</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>
<span class="w">  </span><span class="nt">x-php</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>

<span class="c1"># APIs for `video` media type</span>
<span class="nt">video</span><span class="p">:</span>
</pre></div>
</div>
</details><details>
  <summary>Content of <code class="docutils literal notranslate"><span class="pre">api.yml</span></code> (cluster implementation)</summary><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1">## Configuration for API arguments of BroAPT-APP</span>

<span class="c1">###############################################################################</span>
<span class="c1">## Environment (global setup)</span>
<span class="c1">##</span>
<span class="c1">## Environment variables `${...}` used in API arguments will be translated</span>
<span class="c1">## according to the following values.</span>
<span class="c1">##</span>
<span class="nt">environment</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># API root path</span>
<span class="w">  </span><span class="nt">API_ROOT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${BROAPT_API_ROOT}</span>
<span class="w">  </span><span class="c1"># Python 3.6</span>
<span class="w">  </span><span class="nt">PYTHON</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python3.6</span>
<span class="w">  </span><span class="nt">PYTHON36</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python3.6</span>
<span class="w">  </span><span class="nt">PYTHON3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python3.6</span>
<span class="w">  </span><span class="c1"># Python 2.7</span>
<span class="w">  </span><span class="nt">PYTHON27</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python</span>
<span class="w">  </span><span class="nt">PYTHON2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/python</span>
<span class="w">  </span><span class="c1"># Shell/Bash</span>
<span class="w">  </span><span class="nt">SHELL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/bin/bash</span>

<span class="c1">###############################################################################</span>
<span class="c1">## Example:</span>
<span class="c1">##</span>
<span class="c1">## - Root: `/api/`</span>
<span class="c1">## - Target:</span>
<span class="c1">##   - MIME type: `application/pdf`</span>
<span class="c1">##   - file name: `/dump/application/pdf/test.pdf`</span>
<span class="c1">## - API:</span>
<span class="c1">##   - working directory: `./pdf_analysis`</span>
<span class="c1">##   - environment: `ENV_FOO=1`, `ENV_BAR=this is an environment variable`</span>
<span class="c1">##</span>
<span class="c1">## The configuration section should then be:</span>
<span class="c1">##</span>
<span class="c1">## application:</span>
<span class="c1">##   ...  # other APIs</span>
<span class="c1">##   pdf:</span>
<span class="c1">##     remote: false</span>
<span class="c1">##     workdir: pdf_analysis</span>
<span class="c1">##     environ:</span>
<span class="c1">##       ENV_FOO: 1</span>
<span class="c1">##       ENV_BAR: this is an environment variable</span>
<span class="c1">##     install:</span>
<span class="c1">##       - apt-get update</span>
<span class="c1">##       - apt-get install -y python python-pip</span>
<span class="c1">##       - python -m pip install -r requirements.txt</span>
<span class="c1">##       - rm -rf /var/lib/apt/lists/*</span>
<span class="c1">##       - apt-get remove -y --auto-remove python-pip</span>
<span class="c1">##       - apt-get clean</span>
<span class="c1">##     scripts:</span>
<span class="c1">##       - ${PYTHON27} detect.py [...]                # refer to /usr/bin/python</span>
<span class="c1">##       - ...                                        # and some random command</span>
<span class="c1">##     report: ${PYTHON27} report.py                  # generate final report</span>
<span class="c1">##</span>
<span class="c1">## BroAPT will work as following:</span>
<span class="c1">##</span>
<span class="c1">## 1. set the following environment variables</span>
<span class="c1">##    # per target file</span>
<span class="c1">##    - BROAPT_PATH=&quot;/dump/application/pdf/test.pdf&quot;</span>
<span class="c1">##    - BROAPT_MIME=&quot;application/pdf&quot;</span>
<span class="c1">##    # per API configuration</span>
<span class="c1">##    - ENV_FOO=1</span>
<span class="c1">##    - ENV_BAR=&quot;this is an environment variable&quot;</span>
<span class="c1">## 2. change the current working directory to</span>
<span class="c1">##    `/api/application/pdf/pdf_analysis`</span>
<span class="c1">## 3. if run for the first time, run the following commands:</span>
<span class="c1">##    - `apt-get update`</span>
<span class="c1">##    - `apt-get install -y python python-pip`</span>
<span class="c1">##    - `python -m pip install -r requirements.txt`</span>
<span class="c1">##    - `rm -rf /var/lib/apt/lists/*`</span>
<span class="c1">##    - `apt-get remove -y --auto-remove python-pip`</span>
<span class="c1">##    - `apt-get clean`</span>
<span class="c1">## 4. run the following mid-stage commands:</span>
<span class="c1">##    - `/usr/bin/python detect.py [...]`</span>
<span class="c1">##    - `...`</span>
<span class="c1">## 5. generate final report:</span>
<span class="c1">##    `/usr/bin/python report.py`</span>
<span class="c1">##</span>
<span class="c1">## NOTE: `report` section is MANDATORY.</span>
<span class="c1">##       If `remote` is `true`, then BroAPT will run the</span>
<span class="c1">##       corresponding API in the host machine.</span>
<span class="c1">##</span>

<span class="c1"># APIs for `application` media type</span>
<span class="nt">application</span><span class="p">:</span>
<span class="w">  </span><span class="nt">javascript</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;javascript</span>
<span class="w">    </span><span class="c1">## JaSt</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${API_ROOT}/application/javascript/JaSt</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">JS_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get update</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get install -y --no-install-recommends git nodejs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./JaSt/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/Aurore54F/JaSt.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON3} -m pip install</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">matplotlib</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">plotly</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">scipy</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">scikit-learn</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON3} ./JaSt/clustering/learner.py</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--d ./sample/</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--l ./lables/</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--md ./models/</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--mn broapt-jast</span>
<span class="w">    </span><span class="nt">scripts</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON3} ./JaSt/clustering/classifier.py</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--f ${BROAPT_PATH}</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">--m ./models/broapt-jast</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span>
<span class="w">  </span><span class="nt">octet-stream</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;lmd</span>
<span class="w">    </span><span class="c1">## LMD</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${API_ROOT}/application/octet-stream/LMD</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">LMD_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get install -y --no-install-recommends git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./linux-malware-detect/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/rfxn/linux-malware-detect.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} install.sh</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} detect.sh</span>
<span class="w">  </span><span class="nt">vnd.android.package-archive</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## AndroPyTool</span>
<span class="w">    </span><span class="nt">remote</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AndroPyTool</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># ANDROID_HOME: $HOME/android-sdk-linux</span>
<span class="w">      </span><span class="c1"># PATH: $PATH:$ANDROID_HOME/tools</span>
<span class="w">      </span><span class="c1"># PATH: $PATH:$ANDROID_HOME/platform-tools</span>
<span class="w">      </span><span class="c1"># APK_LOG: /var/log/bro/tmp/</span>
<span class="w">      </span><span class="nt">APK_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/traffic/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># - ${SHELL} install.sh</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker pull alexmyg/andropytool</span>
<span class="w">    </span><span class="c1"># report: ${PYTHON36} detect.py</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} detect.sh</span>
<span class="w">  </span><span class="nt">vnd.openxmlformats-officedocument</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;officedocument</span>
<span class="w">    </span><span class="c1">## MaliciousMacroBot</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${API_ROOT}/application/vnd.openxmlformats-officedocument/</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MMB_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get install -y --no-install-recommends git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./MaliciousMacroBot/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/egaus/MaliciousMacroBot.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON36} -m pip install ./MaliciousMacroBot/</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON36} MaliciousMacroBot-detect.py</span>
<span class="w">    </span><span class="nt">shared</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">officedocument</span>
<span class="w">  </span><span class="nt">msword</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">vnd.ms-*</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">vnd.openxmlformats-officedocument</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">vnd.openxmlformats-officedocument.*</span><span class="p">:</span><span class="w"> </span><span class="nv">*officedocument</span>
<span class="w">  </span><span class="nt">x-executable</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## ELF Parser</span>
<span class="w">    </span><span class="nt">remote</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># ELF_LOG: /var/log/bro/tmp/</span>
<span class="w">      </span><span class="nt">ELF_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/traffic/log/bro/tmp/</span>
<span class="w">      </span><span class="nt">ELF_SCORE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">workdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ELF-Parser</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get update</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-get install -y --no-install-recommends \</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">cmake \</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">g++ \</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">gcc \</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">git \</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">libboost-all-dev \</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">make</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -d ./elfparser/ ||</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">git clone https://github.com/jacob-baines/elfparser.git</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} build.sh</span>
<span class="w">    </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SHELL} detect.sh</span>

<span class="c1"># APIs for `audio` media type</span>
<span class="nt">audio</span><span class="p">:</span>

<span class="c1"># Default API for missing MIME types</span>
<span class="nt">example</span><span class="p">:</span>
<span class="w">  </span><span class="nt">environ</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## sleep interval</span>
<span class="w">    </span><span class="nt">VT_INTERVAL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="c1">## max retry for report</span>
<span class="w">    </span><span class="nt">VT_RETRY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="c1">## percentage of positive threshold</span>
<span class="w">    </span><span class="nt">VT_PERCENT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="c1">## VT API key</span>
<span class="w">    </span><span class="c1">#VT_API: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="w">    </span><span class="c1">## path to VT file scan reports</span>
<span class="w">    </span><span class="nt">VT_LOG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bro/tmp/</span>
<span class="w">  </span><span class="nt">report</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PYTHON36} virustotal.py || exit 0</span><span class="w"> </span><span class="c1"># always EXIT_SUCCESS</span>

<span class="c1"># APIs for `font` media type</span>
<span class="nt">font</span><span class="p">:</span>

<span class="c1"># APIs for `image` media type</span>
<span class="nt">image</span><span class="p">:</span>

<span class="c1"># APIs for `message` media type</span>
<span class="nt">message</span><span class="p">:</span>

<span class="c1"># APIs for `model` media type</span>
<span class="nt">model</span><span class="p">:</span>

<span class="c1"># APIs for `multipart` media type</span>
<span class="nt">multipart</span><span class="p">:</span>

<span class="c1"># APIs for `text` media type</span>
<span class="nt">text</span><span class="p">:</span>
<span class="w">  </span><span class="nt">html</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>
<span class="w">  </span><span class="nt">javascript</span><span class="p">:</span><span class="w"> </span><span class="nv">*javascript</span>
<span class="w">  </span><span class="nt">x-c</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>
<span class="w">  </span><span class="nt">x-perl</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>
<span class="w">  </span><span class="nt">x-php</span><span class="p">:</span><span class="w"> </span><span class="nv">*lmd</span>

<span class="c1"># APIs for `video` media type</span>
<span class="nt">video</span><span class="p">:</span>
</pre></div>
</div>
</details><div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>For bundled implementation, the runtime of <em>local</em> APIs are in the CentOS 7
Docker container.</p>
<p>For cluster implementation, the runtime of <em>local</em> APIs are in the Ubuntu 16.04
Docker container.</p>
</div>
</section>
<section id="wrapper-scripts">
<h2>Wrapper Scripts<a class="headerlink" href="#wrapper-scripts" title="Permalink to this heading">¶</a></h2>
<p>For the Docker container, we have created some Shell/Bash wrapper scripts to
make the life a little bit better.</p>
<section id="bundled-implementation">
<h3>Bundled Implementation<a class="headerlink" href="#bundled-implementation" title="Permalink to this heading">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">File location<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">source/client/init.sh</span></code></p>
</dd>
</dl>
<p>As the BroAPT-App framework is already integrated into the source codes, there’s
no need to another wrapper script to start the BroAPT-App framework. It shall be
run directly after the BroAPT-Core framework.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nb">set</span><span class="w"> </span>-aex

<span class="c1"># change curdir</span>
<span class="nb">cd</span><span class="w"> </span>/broapt

<span class="c1"># load environs</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>.env<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">source</span><span class="w"> </span>.env
<span class="k">fi</span>

<span class="c1"># compose Bro scripts</span>
/usr/bin/python3.6<span class="w"> </span>python/compose.py

<span class="c1"># run scripts</span>
/usr/bin/python3.6<span class="w"> </span>python<span class="w"> </span><span class="nv">$@</span>

<span class="c1"># sleep</span>
sleep<span class="w"> </span>infinity
</pre></div>
</div>
</section>
<section id="cluster-implementation">
<h3>Cluster Implementation<a class="headerlink" href="#cluster-implementation" title="Permalink to this heading">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">File location<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cluster/app/source/init.sh</span></code></p>
</dd>
</dl>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nb">set</span><span class="w"> </span>-aex

<span class="c1"># change cwd</span>
<span class="nb">cd</span><span class="w"> </span>/source

<span class="c1"># load environs</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>.env<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">source</span><span class="w"> </span>.env
<span class="k">fi</span>

<span class="c1"># run scripts</span>
/usr/bin/python3.6<span class="w"> </span>python

<span class="c1"># sleep</span>
sleep<span class="w"> </span>infinity
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">BroAPT</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=JarryShaw&repo=broapt&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="framework.html">Internal Frameworks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api.core.html">BroAPT-Core Framework</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BroAPT-App Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.daemon.html">BroAPT-Daemon Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.misc.html">Miscellaneous &amp; Auxiliary</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#system-runtime">System Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#developer-notes">Developer Notes</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api.html">API Reference</a><ul>
      <li>Previous: <a href="api.core.python.sites.html" title="previous chapter">Site Customisations</a></li>
      <li>Next: <a href="api.app.python.__init__.html" title="next chapter">Module Entry</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Jarry Shaw.
      
      |
      <a href="_sources/api.app.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/JarryShaw/broapt" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>