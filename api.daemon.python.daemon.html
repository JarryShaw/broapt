<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Flask Application &#8212; BroAPT 2020.03.14 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=628af7cf"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Detection Process" href="api.daemon.python.process.html" />
    <link rel="prev" title="Common Constants" href="api.daemon.python.const.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="flask-application">
<h1><a class="reference external" href="https://flask.palletsprojects.coms">Flask</a> Application<a class="headerlink" href="#flask-application" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">File location<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>Bundled implementation: <code class="docutils literal notranslate"><span class="pre">source/server/python/daemon.py</span></code></p></li>
<li><p>Cluster implementation: <code class="docutils literal notranslate"><span class="pre">cluster/daemon/python/daemon.py</span></code></p></li>
</ul>
</dd>
</dl>
<section id="url-routing">
<h2>URL Routing<a class="headerlink" href="#url-routing" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="daemon.root">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">root</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#daemon.root" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p>
</dd>
</dl>
<p>Display help message <a class="reference internal" href="#daemon.__help__" title="daemon.__help__"><code class="xref py py-data docutils literal notranslate"><span class="pre">__help__</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="daemon.help_">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">help_</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#daemon.help_" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p>
</dd>
</dl>
<p>Display help message <a class="reference internal" href="#daemon.HELP_v1_0" title="daemon.HELP_v1_0"><code class="xref py py-data docutils literal notranslate"><span class="pre">HELP_v1_0</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="daemon.list_">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">list_</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#daemon.list_" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0/list</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p>
</dd>
</dl>
<p>List of detection process information.</p>
<ol class="arabic simple" start="0">
<li><p>Information of running processes from <a class="reference internal" href="#daemon.RUNNING" title="daemon.RUNNING"><code class="xref py py-data docutils literal notranslate"><span class="pre">RUNNING</span></code></a>:</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: null,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>Information of finished processes from <a class="reference internal" href="#daemon.SCANNED" title="daemon.SCANNED"><code class="xref py py-data docutils literal notranslate"><span class="pre">SCANNED</span></code></a>:</p>
<ul>
<li><p>If the process exited on success:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: true,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
<li><p>If the process exited on failure:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: false,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="get_none">
<span class="sig-name descname"><span class="pre">get_none</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#get_none" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0/report</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p>
</dd>
</dl>
<p>Display help message:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ID Required: /api/v1.0/report/&lt;id&gt;
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#get" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0/report/&lt;id&gt;</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GET</span></code></p>
</dd>
</dl>
<p>Fetch detection status of <code class="docutils literal notranslate"><span class="pre">id_</span></code>.</p>
<ol class="arabic" start="0">
<li><p>If <code class="docutils literal notranslate"><span class="pre">id_</span></code> in <a class="reference internal" href="#daemon.RUNNING" title="daemon.RUNNING"><code class="xref py py-data docutils literal notranslate"><span class="pre">RUNNING</span></code></a>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: null,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">id_</span></code> in <a class="reference internal" href="#daemon.SCANNED" title="daemon.SCANNED"><code class="xref py py-data docutils literal notranslate"><span class="pre">SCANNED</span></code></a>:</p>
<ul>
<li><p>If the process exited on success:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: true,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
<li><p>If the process exited on failure:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: false,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">id_</span></code> not found, raises <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code> with <a class="reference internal" href="#daemon.id_not_found" title="daemon.id_not_found"><code class="xref py py-func docutils literal notranslate"><span class="pre">id_not_found()</span></code></a>.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="daemon.scan">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">scan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#daemon.scan" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0/scan</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">POST</span></code></p>
</dd>
</dl>
<p>Perform <em>remote</em> detection on target file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">POST</span></code> data should be a JSON object with following fields:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – path to the extracted file</p></li>
<li><p><strong>mime</strong> (<em>string</em>) – MIME type</p></li>
<li><p><strong>uuid</strong> (<em>string</em>) – unique identifier</p></li>
<li><p><strong>report</strong> (<em>string</em><em> | </em><em>string</em><em>[</em><em>]</em>) – report generation commands</p></li>
<li><p><strong>shared</strong> (<em>string</em>) – shared detection API identifier</p></li>
<li><p><strong>inited</strong> (<em>boolean</em>) – API initialised</p></li>
<li><p><strong>workdir</strong> (<em>string</em>) – working directory</p></li>
<li><p><strong>environ</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – environment variables</p></li>
<li><p><strong>install</strong> (<em>string</em><em> | </em><em>string</em><em>[</em><em>]</em>) – initialisation commands</p></li>
<li><p><strong>scripts</strong> (<em>string</em><em> | </em><em>string</em><em>[</em><em>]</em>) – detection commands</p></li>
</ul>
</dd>
</dl>
<p>If <strong>NO</strong> JSON data provided, raises <code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> with <a class="reference internal" href="#daemon.invalid_info" title="daemon.invalid_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">invalid_info()</span></code></a>.</p>
<p>After performing detection <a class="reference internal" href="api.daemon.python.process.html#process.process" title="process.process"><code class="xref py py-func docutils literal notranslate"><span class="pre">process.process()</span></code></a> on the target file,
returns a JSON object containing detection report:</p>
<ol class="arabic" start="0">
<li><p>If detection exits on success:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: true,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
<li><p>If detection exists on failure:</p>
<ul>
<li><p>If detection fails when initialising:</p>
<blockquote>
<div><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: false,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>If detection fails when processing:</p>
<blockquote>
<div><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: false,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: false</span>
<span class="err">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delete_none">
<span class="sig-name descname"><span class="pre">delete_none</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#delete_none" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0/delete</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code></p>
</dd>
</dl>
<p>Display help message:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ID Required: /api/v1.0/delete/&lt;id&gt;
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#delete" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Route<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/api/v1.0/delete/&lt;id&gt;</span></code></p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code></p>
</dd>
</dl>
<p>Delete detection status of <code class="docutils literal notranslate"><span class="pre">id_</span></code>.</p>
<ol class="arabic" start="0">
<li><p>If <code class="docutils literal notranslate"><span class="pre">id_</span></code> in <a class="reference internal" href="#daemon.RUNNING" title="daemon.RUNNING"><code class="xref py py-data docutils literal notranslate"><span class="pre">RUNNING</span></code></a>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: null,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: true</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">id_</span></code> in <a class="reference internal" href="#daemon.SCANNED" title="daemon.SCANNED"><code class="xref py py-data docutils literal notranslate"><span class="pre">SCANNED</span></code></a>:</p>
<ul>
<li><p>If the process exited on success:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: true,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: true</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
<li><p>If the process exited on failure:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: false,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: true</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">id_</span></code> not found:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;reported: null,</span>
<span class="s2">  &quot;</span><span class="err">dele</span><span class="kc">te</span><span class="err">d&quot;: true</span>
<span class="err">}</span>
</pre></div>
</div>
</li>
</ol>
</dd></dl>

</section>
<section id="error-handlers">
<h2>Error Handlers<a class="headerlink" href="#error-handlers" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="daemon.invalid_id">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">invalid_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.12)"><span class="pre">Exception</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#daemon.invalid_id" title="Link to this definition">¶</a></dt>
<dd><p>Handler of <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;invalid ID format&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="daemon.invalid_info">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">invalid_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.12)"><span class="pre">Exception</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#daemon.invalid_info" title="Link to this definition">¶</a></dt>
<dd><p>Handler of <code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> and <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;invalid info format&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="daemon.id_not_found">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">id_not_found</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.12)"><span class="pre">Exception</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#daemon.id_not_found" title="Link to this definition">¶</a></dt>
<dd><p>Handler of <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ID not found&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="dataclasses">
<h2>Dataclasses<a class="headerlink" href="#dataclasses" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="daemon.INFO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">INFO</span></span><a class="headerlink" href="#daemon.INFO" title="Link to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://www.python.org/dev/peps/pep-0557">dataclass</a> for requested detection API information.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.INFO.name" title="Link to this definition">¶</a></dt>
<dd><p>Path to the extracted file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.uuid">
<span class="sig-name descname"><span class="pre">uuid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.INFO.uuid" title="Link to this definition">¶</a></dt>
<dd><p>Unique identifier of current process.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.mime">
<span class="sig-name descname"><span class="pre">mime</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.INFO.mime" title="Link to this definition">¶</a></dt>
<dd><p>MIME type.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.report">
<span class="sig-name descname"><span class="pre">report</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.INFO.report" title="Link to this definition">¶</a></dt>
<dd><p>Report generation command.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.inited">
<span class="sig-name descname"><span class="pre">inited</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">manager.Value</span></em><a class="headerlink" href="#daemon.INFO.inited" title="Link to this definition">¶</a></dt>
<dd><p>Initied flag.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.locked">
<span class="sig-name descname"><span class="pre">locked</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.Lock" title="(in Python v3.12)"><span class="pre">multiprocessing.Lock</span></a></em><a class="headerlink" href="#daemon.INFO.locked" title="Link to this definition">¶</a></dt>
<dd><p>Multiprocessing runtime lock.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.workdir">
<span class="sig-name descname"><span class="pre">workdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.INFO.workdir" title="Link to this definition">¶</a></dt>
<dd><p>API working directory.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.environ">
<span class="sig-name descname"><span class="pre">environ</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#daemon.INFO.environ" title="Link to this definition">¶</a></dt>
<dd><p>API runtime environment variables.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.install">
<span class="sig-name descname"><span class="pre">install</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#daemon.INFO.install" title="Link to this definition">¶</a></dt>
<dd><p>List of installation commands.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="daemon.INFO.scripts">
<span class="sig-name descname"><span class="pre">scripts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#daemon.INFO.scripts" title="Link to this definition">¶</a></dt>
<dd><p>List of detection commands.</p>
</dd></dl>

</dd></dl>

</section>
<section id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="daemon.app">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">app</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">flask.Flask(__name__)</span></em><a class="headerlink" href="#daemon.app" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://flask.palletsprojects.coms">Flask</a> application.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.HELP_v1_0">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">HELP_v1_0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.HELP_v1_0" title="Link to this definition">¶</a></dt>
<dd><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>BroAPT Daemon APIv1.0 Usage:

- GET    /api/v1.0/list
- GET    /api/v1.0/report/&lt;id&gt;
- POST   /api/v1.0/scan data={&quot;key&quot;: &quot;value&quot;}
- DELETE /api/v1.0/delete/&lt;id&gt;
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.__help__">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">__help__</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#daemon.__help__" title="Link to this definition">¶</a></dt>
<dd><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>BroAPT Daemon API Usage:

# v1.0

- GET    /api/v1.0/list
- GET    /api/v1.0/report/&lt;id&gt;
- POST   /api/v1.0/scan data={&quot;key&quot;: &quot;value&quot;}
- DELETE /api/v1.0/delete/&lt;id&gt;
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.manager">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">manager</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">multiprocessing.Manager()</span></em><a class="headerlink" href="#daemon.manager" title="Link to this definition">¶</a></dt>
<dd><p>Multiprocessing manager instanace.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.RUNNING">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">RUNNING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">manager.list()</span></em><a class="headerlink" href="#daemon.RUNNING" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">List[uuid.UUID]</span></code></p>
</dd>
</dl>
<p>List of running detection processes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.SCANNED">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">SCANNED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">manager.dict()</span></em><a class="headerlink" href="#daemon.SCANNED" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[uuid.UUID,</span> <span class="pre">bool]</span></code></p>
</dd>
</dl>
<p>Record of finished detection processes and exit on success.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.APILOCK">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">APILOCK</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">manager.dict()</span></em><a class="headerlink" href="#daemon.APILOCK" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">multiprocessing.Lock]</span></code></p>
</dd>
</dl>
<p>Record of API multiprocessing locks.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="daemon.APIINIT">
<span class="sig-prename descclassname"><span class="pre">daemon.</span></span><span class="sig-name descname"><span class="pre">APIINIT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">manager.dict()</span></em><a class="headerlink" href="#daemon.APIINIT" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">multiprocessing.Value]</span></code></p>
</dd>
</dl>
<p>Record of API initialised flags.</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">BroAPT</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=JarryShaw&repo=broapt&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="framework.html">Internal Frameworks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api.core.html">BroAPT-Core Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.app.html">BroAPT-App Framework</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="api.daemon.html">BroAPT-Daemon Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.misc.html">Miscellaneous &amp; Auxiliary</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#system-runtime">System Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#developer-notes">Developer Notes</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api.html">API Reference</a><ul>
  <li><a href="api.daemon.html">BroAPT-Daemon Server</a><ul>
      <li>Previous: <a href="api.daemon.python.const.html" title="previous chapter">Common Constants</a></li>
      <li>Next: <a href="api.daemon.python.process.html" title="next chapter">Detection Process</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2020, Jarry Shaw.
      
      |
      <a href="_sources/api.daemon.python.daemon.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/JarryShaw/broapt" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>